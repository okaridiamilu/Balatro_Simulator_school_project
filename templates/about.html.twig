{% extends "base.html.twig" %}

{# Import your macro file #}
{% import 'alert.html.twig' as alerts %}

{% block title %}Dictionnaire des Jokers - BALATRO SIMULATOR{% endblock %}

{% block body %}
<h1>Dictionnaire des Jokers de BALATRO SIMULATOR</h1>

{# Afficher les messages flash #}
{% for message in app.flashes('success') %}
    <div style="background-color: #28a745; color: white; padding: 15px; border-radius: 5px; margin: 15px 0;">
        ‚úÖ {{ message }}
    </div>
{% endfor %}

<p>Total de jokers : <strong>{{ totalJokers }}</strong> | Affich√©s : <strong>{{ jokers|length }}</strong></p>

{# Formulaire de filtre #}
<div style="background-color: #f5f5f5; padding: 20px; border-radius: 8px; margin: 20px 0;">
    <h2>üîç Filtrer les jokers</h2>
    {{ form_start(filterForm) }}
        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 15px;">
            <div>
                {{ form_label(filterForm.nom) }}
                {{ form_widget(filterForm.nom) }}
            </div>
            <div>
                {{ form_label(filterForm.etat) }}
                {{ form_widget(filterForm.etat) }}
            </div>
            <div>
                {{ form_label(filterForm.rarete) }}
                {{ form_widget(filterForm.rarete) }}
            </div>
        </div>
        <button type="submit" style="background-color: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer;">
            Filtrer
        </button>
        <a href="{{ path('about') }}" style="margin-left: 10px; padding: 10px 20px; background-color: #6c757d; color: white; text-decoration: none; border-radius: 5px; display: inline-block;">
            R√©initialiser
        </a>
    {{ form_end(filterForm) }}
</div>

{# Affichage des jokers #}
{% if jokers|length > 0 %}
    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">
        {% for joker in jokers %}
            <div style="border: 2px solid #ddd; border-radius: 10px; padding: 15px; background-color: white; box-shadow: 2px 2px 10px rgba(0,0,0,0.1);">
                {# Image du joker #}
                <div style="text-align: center; margin-bottom: 15px;">
                    <img src="{{ joker.image ?? '/images/joker-default.jpg' }}" 
                        alt="{{ joker.nom }}" 
                        style="max-width: 100%; height: auto; border-radius: 8px; max-height: 200px;">
                </div>
                
                <h3 style="margin-top: 0; color: #333;">
                    {{ joker.nom }}
                    {% if joker.etat.value == 'foil' %}
                        ‚ú®
                    {% elseif joker.etat.value == 'polychrome' %}
                        üåà
                    {% elseif joker.etat.value == 'holographique' %}
                        üíé
                    {% elseif joker.etat.value == 'negatif' %}
                        ‚ö´
                    {% endif %}
                </h3>
                
                <p style="margin: 10px 0;">
                    <strong>√âtat :</strong> 
                    <span style="background-color: #e9ecef; padding: 3px 8px; border-radius: 3px;">
                        {{ joker.etat.value|capitalize }}
                    </span>
                </p>
                
                <p style="margin: 10px 0;">
                    <strong>Raret√© :</strong>
                    <span style="
                        padding: 3px 8px; 
                        border-radius: 3px; 
                        color: white;
                        {% if joker.rarete.value == 'commun' %}
                            background-color: #6c757d;
                        {% elseif joker.rarete.value == 'uncommun' %}
                            background-color: #28a745;
                        {% elseif joker.rarete.value == 'rare' %}
                            background-color: #007bff;
                        {% elseif joker.rarete.value == 'legendary' %}
                            background-color: #ffc107; color: #000;
                        {% endif %}
                    ">
                        {{ joker.rarete.value|upper }}
                    </span>
                </p>
                
                <p style="font-style: italic; color: #666; margin: 10px 0;">
                    {{ joker.description }}
                </p>
                
                {# Boutons d'action #}
                <div style="display: flex; gap: 10px; margin-top: 15px; border-top: 1px solid #ddd; padding-top: 15px;">
                    <a href="{{ path('joker_edit', {'id': joker.id}) }}" 
                    style="flex: 1; text-align: center; padding: 8px 15px; background-color: #007bff; color: white; text-decoration: none; border-radius: 5px;">
                        ‚úèÔ∏è Modifier
                    </a>
                    <form method="post" action="{{ path('joker_delete', {'id': joker.id}) }}" style="flex: 1; margin: 0;" 
                        onsubmit="return confirm('√ätes-vous s√ªr de vouloir supprimer {{ joker.nom }} ?');">
                        <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ joker.id) }}">
                        <button type="submit" style="width: 100%; padding: 8px 15px; background-color: #dc3545; color: white; border: none; border-radius: 5px; cursor: pointer;">
                            üóëÔ∏è Supprimer
                        </button>
                    </form>
                </div>
            </div>
        {% endfor %}
    </div>
{% else %}
    {{ alerts.alert('warning', 'Aucun joker ne correspond aux crit√®res de recherche.') }}
{% endif %}

{% endblock %}